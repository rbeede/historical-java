
  

  
  

  
  

  

  
  

  
  

  
  

  

  

  

  

  

  
  
  
  
      
  

      
      
      
      
      
      
        
         
      
      

      
      
      
      

      
      
      

      

  
  

  
  

   
   

   
   


    
	
	

    
    
      
	
	
	<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

    <html>
      <head>
        
        
        
          <title>HttpClient - 
          Cross Host Redirects
        </title>
        
        
        <style type="text/css">
          @import url("./style/tigris.css");
          @import url("./style/maven.css");
        </style>
        
        
        
        
        
        <link rel="stylesheet" href="./style/print.css" type="text/css" media="print"></link>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta>
        
          <meta name="author" content="Adrian Sutton"></meta>
          <meta name="email" content="adrian@ephox.com"></meta>
        
        
        
        
      </head>

      <body class="composite">

        <div id="banner">
          <table border="0" width="100%" cellpadding="8" cellspacing="0">
            <tr>
              
              <td>
                
                
                  
                  
                  
                    
                  
                  
                  
                  
                  
                  <a href="http://jakarta.apache.org/">
                    <img border="0" alt="Apache Software Foundation" src="http://jakarta.apache.org/commons/images/jakarta-logo-blue.gif" align="left"></img>
                  </a>
                
              </td>

              
              <td>
                <div id="login" align="right">
                  
                  
                    
                    
                    
                      
                    

                    <a href="http://jakarta.apache.org/commons/httpclient/">
                      <img border="0" alt="HttpClient" src="./images/httpclient_logo.png" align="right"></img>
                    </a>
                  
                </div>
              </td>
            </tr>
          </table>
        </div>
        <div id="breadcrumbs">
          <table border="0" width="100%" cellpadding="4" cellspacing="0">
            <tr>
              
                
                <td>Last published: 13 October 2003
                  | Doc for 2.0-rc2
                </td>
              
              <td>
                <div align="right">
                  
                  
                  
                  
                    
                  
                </div>
              </td>
            </tr>
          </table>
        </div>
        
        <table border="0" width="100%" cellpadding="8" cellspacing="0"> 
          <tr valign="top">
            <td width="20%" id="leftcol">
              <div id="navcolumn">
                

                
                  
    <div>
      <strong>Overview</strong>
      
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="features.html"><img class="handle" src="./images/none.png" alt=""></img>Features</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="news.html"><img class="handle" src="./images/none.png" alt=""></img>News</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="status.html"><img class="handle" src="./images/none.png" alt=""></img>Status</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="downloads.html"><img class="handle" src="./images/none.png" alt=""></img>Download</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="applications.html"><img class="handle" src="./images/none.png" alt=""></img>Applications</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		
          
		
		
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="userguide.html"><img class="handle" src="./images/expanded.png" alt=""></img>User Guide</a>
      	
      </small>
	  
        
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="authentication.html"><img class="handle" src="./images/none.png" alt=""></img>Authentication Guide</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="charencodings.html"><img class="handle" src="./images/none.png" alt=""></img>Character Encodings</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="cookies.html"><img class="handle" src="./images/none.png" alt=""></img>Cookies</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      		<b><a href="redirects.html"><img class="handle" src="./images/none.png" alt=""></img>Cross Host Redirects</a></b>
      	
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="logging.html"><img class="handle" src="./images/none.png" alt=""></img>Logging Guide</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="methods.html"><img class="handle" src="./images/none.png" alt=""></img>Methods</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="http://cvs.apache.org/viewcvs.cgi/jakarta-commons/httpclient/src/examples/"><img class="handle" src="./images/none.png" alt=""></img>Sample Code</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="sslguide.html"><img class="handle" src="./images/none.png" alt=""></img>SSL Guide</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="threading.html"><img class="handle" src="./images/none.png" alt=""></img>Threading</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="troubleshooting.html"><img class="handle" src="./images/none.png" alt=""></img>Trouble Shooting</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="tutorial.html"><img class="handle" src="./images/none.png" alt=""></img>Tutorial</a>
      	
      </small>
	  
        
      
    </div>
  
      
    </div>
  
    
    
    
    
	
	
	
	
	
		
          
		
		
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="developerguide.html"><img class="handle" src="./images/expanded.png" alt=""></img>Developer Guide</a>
      	
      </small>
	  
        
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="releases.html"><img class="handle" src="./images/none.png" alt=""></img>Release Process</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="testwebapp.html"><img class="handle" src="./images/none.png" alt=""></img>Webapp Test Guide</a>
      	
      </small>
	  
        
      
    </div>
  
      
    </div>
  
    </div>
  
                

				
    <div>
      <strong>Project Documentation</strong>
      
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="index.html"><img class="handle" src="./images/none.png" alt=""></img>About HttpClient</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		
		
          
		
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="project-info.html"><img class="handle" src="./images/collapsed.png" alt=""></img>Project Info</a>
      	
      </small>
	  
    </div>
  
    
    
    
    
	
	
	
	
	
		
		
          
		
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="maven-reports.html"><img class="handle" src="./images/collapsed.png" alt=""></img>Project Reports</a>
      	
      </small>
	  
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="apidocs/index.html"><img class="handle" src="./images/none.png" alt=""></img>JavaDocs</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="xref/index.html"><img class="handle" src="./images/none.png" alt=""></img>Source XReference</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="xref-test/index.html"><img class="handle" src="./images/none.png" alt=""></img>Test XReference</a>
      	
      </small>
	  
        
      
    </div>
  
    
    
    
    
	
	
	
	
	
		   
	
    <div>
      <small>
      	
      	
      		<a href="http://maven.apache.org/development-process.html"><img class="handle" src="./images/none.png" alt=""></img>Development Process</a>
      	
      </small>
	  
        
      
    </div>
  
    </div>
  
                
                
                

                
                
                
                
                	<div style="margin-top: 20px; width: 100%; text-align: center;">
                		<a href="http://maven.apache.org/" title="Powered by Maven"><img style="border: 1px solid black" alt="Powered by Maven" src="./images/logos/maven-propaganda.png"></img></a>
                	</div>
                
              
                
              </div>
            </td>
            <td rowspan="2">
              <div id="bodycol">
                
                <div class="app">
                  
                  
    <div class="h3">
      
      
        <h3>
          <a name="Introduction">Introduction</a>
        </h3>
      
      
    <p>
      
     This document provides a brief guide to handling cross host redirects
   
     
        with 
   
    <em>
      
     HttpClient
   
    </em>
   
     .  In future versions, it is anticipated that
   
     
        this will be handled by the 
   
    <code>
      
     HttpClient
   
    </code>
   
      class automatically.  
   
     
        However due to technical constraints and the desire to stabilise the API for a 2.0
   
     
        release sooner rather than later, this ability is yet to be implemented.
   
     
        Redirects to a different URL on the same host, port and protocol is supported.
   
    </p>
   
    <p>
      
     There are also a few types of redirect that HttpClient can't handle
   
     
        automatically either because they require user interaction or are
   
     
        outside of the scope of HttpClient.  These status codes are listed 
   
    <a href="#Special%20Redirect%20Codes">
     below
   </a>
  
     .
   
    </p>
   
    </div>
  
    <div class="h3">
      
      
        <h3>
          <a name="Handling Redirects">Handling Redirects</a>
        </h3>
      
      
    <p>
      
     When a server returns a redirect instruction to HttpClient that
   
     
      requires connecting to a different host, HttpClient will simply return
   
     
      the redirect status code as the response status.  All response codes
   
     
      between 300 and 399 inclusive are redirect resonses of
   
     
      some form.  The most common redirect response codes are:
   
    </p>
   
    <ul>
      
     
        
   
    <li>
      
     301 Moved Permanently.
   
     
        
   
    <code>
      
     HttpStatus.SC_MOVED_PERMANENTLY
   
    </code>
   
    </li>
   
     

        
   
    <li>
      
     302 Moved Temporarily.
   
     
        
   
    <code>
      
     HttpStatus.SC_MOVED_TEMPORARILY
   
    </code>
   
    </li>
   
     

        
   
    <li>
      
     303 See Other. 
   
    <code>
      
     HttpStatus.SC_SEE_OTHER
   
    </code>
   
    </li>
   
     

        
   
    <li>
      
     307 Temporary Redirect.
   
     
        
   
    <code>
      
     HttpStatus.SC_TEMPORARY_REDIRECT
   
    </code>
   
    </li>
   
     
      
   
    </ul>
   
    <p>
      
    <b>
      
     Note:
   
    </b>
   
      there are a number of response codes in the 3xx range
   
     
      which do not simply indicate a different URI to send the request to.
   
     
      These response codes are listed 
   
    <a href="#Special%20Redirect%20Codes">
     below
   </a>
  
      and the manner they are
   
     
      handled will be application specific.
   
    </p>
   
    <p>
      
     When your application receives one of the "simple" redirect responses,
   
     
      it should extract the new URL from the HttpMethod object and retry
   
     
      downloading from that URL.  
   
     
        Additionally, it is usually a good idea to limit the number of
   
     
        redirects that will be followed in case the redirects form a recursive
   
     
        loop.
   
    </p>
   
    <p>
      
     The URL to connect to can be extracted from the 
   
    <tt>
      
     Location
   
    </tt>
   
     
      header.
   
    </p>
   
    <div id="source">
      <pre>
        String redirectLocation;
        Header locationHeader = method.getResponseHeader("location");
        if (locationHeader != null) {
            redirectLocation = locationHeader.getValue();
        } else {
            // The response is invalid and did not provide the new location for
            // the resource.  Report an error or possibly handle the response
            // like a 404 Not Found error.
        }
      </pre>
    </div>
  
    <p>
      
     Once you have determined the new location, you can reattempt the
   
     
      connection as normal.  See the 
   
    <a href="tutorial.html">
     Tutorial
   </a>
  
      for
   
     
      more information on this.
   
    </p>
   
    </div>
  
    <div class="h3">
      
      
        <h3>
          <a name="Special Redirect Codes">Special Redirect Codes</a>
        </h3>
      
      
    <p>
      
     The HTTP specification defines a number of somewhat unusual redirect
   
     
      response codes that will likely need to be handled in a different manner
   
     
      to the codes above.  In particular these are:
   
    </p>
   
    <ul>
      
     
        
   
    <li>
      
     300 Multiple Choices.
   
     
        
   
    <code>
      
     HttpStatus.SC_MULTIPLE_CHOICES
   
    </code>
   
    <br>
      
    </br>
   
     
        
   
    <p>
      
     There are multiple choices available for the redirection.  A
   
     
        preferred redirect URI may be specified in the location header, however
   
     
        generally it is expected that the user will be given the choice of
   
     
        which URI to be redirected to.  It is however permissible to simply
   
     
        select one of the available choices arbitrarily.
   
    </p>
   
     
        
   
    </li>
   
     
        
   
    <li>
      
     304 Not Modified.
   
     
        
   
    <code>
      
     HttpStatus.SC_NO
   
     T_MODIFIED
   
    </code>
   
    <br>
      
    </br>
   
     
        
   
    <p>
      
     The resource has not been modified since it was last requested.  You
   
     
        should retrieve the resource from cache instead.  If the resource is no
   
     
        longer available in the cache the request should be retried without the
   
     
        conditional headers.
   
    </p>
   
     
        
   
    </li>
   
     
        
   
    <li>
      
     305 Use Proxy.
   
     
        
   
    <code>
      
     HttpStatus.SC_USE_PROXY
   
    </code>
   
    <br>
      
    </br>
   
     
        
   
    <p>
      
     The resource must be accessed through the specified proxy.  The
   
     
        proxy is specified in the Location header.
   
    </p>
   
     
        
   
    </li>
   
     
      
   
    </ul>
   
    </div>
  
                  
                  
                  
                  
                  
                </div>
              </div>
            </td>
          </tr>
        </table>
        <div id="footer">
          <table border="0" style="width:100%" cellpadding="4" cellspacing="0">
            
            <tr>
              <td>
                
                  
                    
                    
                      © 2001-2003, Apache Software Foundation
                    
                  
                  
                

                
              </td>
              
            </tr>
          </table>
        </div>
      </body>
    </html>
  